{
   "name":"Cb Protection",
   "description":"Creates a content pack for Cb Protection",
   "category":"Security",
   "inputs":[
      {
         "title":"Cb-Protection-Syslog",
         "configuration":{
            "expand_structured_data":false,
            "recv_buffer_size":262144,
            "port":11005,
            "override_source":null,
            "force_rdns":false,
            "allow_override_date":true,
            "bind_address":"0.0.0.0",
            "store_full_message":true
         },
         "static_fields":{

         },
         "type":"org.graylog2.inputs.syslog.udp.SyslogUDPInput",
         "global":true,
         "extractors":[
            {
               "title":"ip_address",
               "type":"GROK",
               "cursor_strategy":"COPY",
               "target_field":"",
               "source_field":"full_message",
               "configuration":{
                  "grok_pattern":"ip_address=\"%{IP:ip_address}\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":11
            },
            {
               "title":"Process",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"process",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"process=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":9
            },
            {
               "title":"file_path",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"file_path",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"file_path=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":13
            },
            {
               "title":"file_name",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"file_name",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"file_name=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":12
            },
            {
               "title":"file_hash",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"file_hash",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"file_hash=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":7
            },
            {
               "title":"policy",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"policy",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"policy=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":14
            },
            {
               "title":"process_key",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"process_key",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"process_key=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":6
            },
            {
               "title":"server_version",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"server_version",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"server_version=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":15
            },
            {
               "title":"Message",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"message",
               "source_field":"message",
               "configuration":{
                  "regex_value":"text=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":20
            },
            {
               "title":"Subtype",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"subtype",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"subtype=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":8
            },
            {
               "title":"Type",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"type",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"type=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":4
            },
            {
               "title":"Hostname",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"hostname",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"hostname=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":10
            },
            {
               "title":"username",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"username",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"username=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":3
            },
            {
               "title":"Date",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"date",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"date=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":5
            },
            {
               "title":"rule_name",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"rule_name",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"rule_name=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":0
            },
            {
               "title":"updater_namer",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"updater_name",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"updater_name=\"([^\"]+)\""
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":0
            },
            {
               "title":"file_threat",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"file_threat",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"file_threat=\"([^\"]+)\""
               },
               "converters":[
                  {
                     "type":"NUMERIC",
                     "configuration":{

                     }
                  }
               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":17
            },
            {
               "title":"file_trust",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"file_trust",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"file_trust=\"([^\"]+)\""
               },
               "converters":[
                  {
                     "type":"NUMERIC",
                     "configuration":{

                     }
                  }
               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":16
            },
            {
               "title":"process_trust",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"process_trust",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"process_trust=\"([^\"]+)\""
               },
               "converters":[
                  {
                     "type":"NUMERIC",
                     "configuration":{

                     }
                  }
               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":18
            },
            {
               "title":"process_threat",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"process_threat",
               "source_field":"full_message",
               "configuration":{
                  "regex_value":"process_threat=\"([^\"]+)\""
               },
               "converters":[
                  {
                     "type":"NUMERIC",
                     "configuration":{

                     }
                  }
               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":19
            }
         ]
      }
   ],
   "streams":[

   ],
   "outputs":[

   ],
   "dashboards":[
      {
         "title":"Cb Protection",
         "description":"Cb Protection Overview",
         "dashboard_widgets":[
            {
               "description":"Top Unapproved File Hashes",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":86400
                  },
                  "field":"file_hash",
                  "show_pie_chart":false,
                  "query":"source:subtype:\"New unapproved file to computer\"",
                  "show_data_table":true
               },
               "col":2,
               "row":2,
               "height":2,
               "width":1
            },
            {
               "description":"Top Unapproved Files Generated IP",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":86400
                  },
                  "field":"ip_address",
                  "show_pie_chart":false,
                  "query":"source:subtype:\"New unapproved file to computer\"",
                  "show_data_table":true
               },
               "col":1,
               "row":2,
               "height":2,
               "width":1
            },
            {
               "description":"Top Unapproved File by Policy",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":86400
                  },
                  "field":"policy",
                  "show_pie_chart":false,
                  "query":"source:subtype:\"New unapproved file to computer\"",
                  "show_data_table":true
               },
               "col":3,
               "row":2,
               "height":2,
               "width":1
            },
            {
               "description":"Process Generating Unapproved File",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":86400
                  },
                  "field":"process",
                  "show_pie_chart":false,
                  "query":"source:subtype:\"New unapproved file to computer\"",
                  "show_data_table":true
               },
               "col":1,
               "row":4,
               "height":2,
               "width":1
            },
            {
               "description":"User Generating Unapproved Files",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":86400
                  },
                  "field":"username",
                  "show_pie_chart":false,
                  "query":"source:subtype:\"New unapproved file to computer\"",
                  "show_data_table":true
               },
               "col":5,
               "row":1,
               "height":3,
               "width":1
            },
            {
               "description":"Username Generating Unapproved",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":86400
                  },
                  "field":"username",
                  "show_pie_chart":false,
                  "query":"source:subtype:\"New unapproved file to computer\"",
                  "show_data_table":true
               },
               "col":2,
               "row":4,
               "height":2,
               "width":1
            },
            {
               "description":"New Unapproved Files (24HR)",
               "type":"SEARCH_RESULT_COUNT",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":86400
                  },
                  "lower_is_better":false,
                  "trend":true,
                  "query":"source:subtype:\"New unapproved file to computer\""
               },
               "col":1,
               "row":1,
               "height":1,
               "width":3
            }
         ]
      }
   ],
   "grok_patterns":[

   ]
}
